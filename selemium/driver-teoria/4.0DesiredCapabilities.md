### **Tutorial: Uso de Desired Capabilities en Selenium WebDriver**

#### **Introducción**

En Selenium WebDriver, las "Desired Capabilities" (capacidades deseadas) son un conjunto de opciones que configuran el entorno en el que se ejecutarán las pruebas automatizadas. Estas capacidades permiten especificar el navegador, la plataforma (sistema operativo) y otras configuraciones necesarias para la ejecución de pruebas en entornos locales, remotos, o distribuidos (como Selenium Grid).

Este tutorial abordará el concepto teórico de las Desired Capabilities y proporcionará ejemplos prácticos de su uso en la automatización de pruebas.

#### **Teoría de Desired Capabilities**

Las Desired Capabilities se usan para configurar aspectos del navegador antes de que la instancia de WebDriver se inicialice. Algunos de los casos de uso típicos son:

1. **Especificar el navegador y su versión.**
2. **Definir la plataforma o sistema operativo.**
3. **Aceptar certificados de seguridad inseguros.**
4. **Configurar preferencias del navegador.**
5. **Conectar con Selenium Grid para ejecutar pruebas de manera distribuida.**

Al usar `DesiredCapabilities`, puedes asegurarte de que las pruebas se ejecuten en un entorno específico con la configuración adecuada, lo que es especialmente útil para ejecutar pruebas en múltiples navegadores o plataformas.

#### **Cómo Configurar Desired Capabilities en Selenium**

Selenium proporciona una clase `DesiredCapabilities` con capacidades predeterminadas para varios navegadores. Estas capacidades pueden ser modificadas según las necesidades del entorno de prueba. 

Algunos ejemplos de configuraciones predeterminadas son:

- **FIREFOX**: `{'acceptInsecureCerts': True, 'browserName': 'firefox', 'moz:debuggerAddress': True}`
- **CHROME**: `{'browserName': 'chrome'}`
- **EDGE**: `{'browserName': 'MicrosoftEdge'}`
- **SAFARI**: `{'browserName': 'safari', 'platformName': 'mac'}`

#### **Configuración Básica de Desired Capabilities**

Cuando creas una instancia de Desired Capabilities, es recomendable hacer una copia del objeto predefinido para evitar efectos secundarios que puedan alterar la clase global. Esto se hace utilizando `.copy()`.

Ejemplo básico de configuración:

```python
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities

# Crear una copia de las Desired Capabilities para Firefox
capabilities = DesiredCapabilities.FIREFOX.copy()

# Modificar las capacidades
capabilities['platform'] = "WINDOWS"
capabilities['version'] = "10"
capabilities['acceptInsecureCerts'] = True  # Aceptar certificados inseguros
```

#### **Ejemplo Práctico 1: Conectar con Selenium Grid**

Selenium Grid permite ejecutar pruebas en múltiples máquinas y navegadores. Para conectarse a un nodo en la red, debes especificar las Desired Capabilities del navegador y usar `webdriver.Remote`.

```python
from selenium import webdriver
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities

# URL del Selenium Grid
selenium_grid_url = "http://198.0.0.1:4444/wd/hub"

# Crear un objeto Desired Capabilities para Firefox
capabilities = DesiredCapabilities.FIREFOX.copy()
capabilities['platform'] = "WINDOWS"
capabilities['version'] = "10"

# Inicializar el WebDriver remoto con las Desired Capabilities
driver = webdriver.Remote(
    command_executor=selenium_grid_url,
    desired_capabilities=capabilities
)

# Abrir una página web
driver.get('https://www.example.com')

# Cerrar el navegador
driver.quit()
```

#### **Ejemplo Práctico 2: Configurar Chrome para Aceptar Certificados Inseguros**

Es común encontrarse con sitios web que usan certificados de seguridad no válidos. Para automatizar pruebas en estas páginas, se pueden configurar las Desired Capabilities para aceptar estos certificados.

```python
from selenium import webdriver
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities

# Configurar Desired Capabilities para Chrome
capabilities = DesiredCapabilities.CHROME.copy()
capabilities['acceptInsecureCerts'] = True

# Iniciar el WebDriver con las capacidades deseadas
driver = webdriver.Chrome(desired_capabilities=capabilities)

# Abrir una página con un certificado inseguro
driver.get('https://self-signed.badssl.com/')

# Cerrar el navegador
driver.quit()
```

#### **Ejemplo Práctico 3: Ejecutar Pruebas en Múltiples Navegadores Usando un Bucle**

Puedes usar Desired Capabilities para ejecutar pruebas en diferentes navegadores de forma programática.

```python
from selenium import webdriver
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities

# Lista de navegadores y sus capacidades
navegadores = [
    DesiredCapabilities.FIREFOX.copy(),
    DesiredCapabilities.CHROME.copy(),
    DesiredCapabilities.EDGE.copy()
]

# URL de la página de prueba
url_prueba = 'https://www.example.com'

# Ejecutar la prueba en cada navegador
for capabilities in navegadores:
    # Iniciar el WebDriver remoto
    driver = webdriver.Remote(
        command_executor='http://198.0.0.1:4444/wd/hub',
        desired_capabilities=capabilities
    )
    
    # Abrir la página de prueba
    driver.get(url_prueba)
    
    # Imprimir el título de la página
    print(f"Título de la página en {capabilities['browserName']}: {driver.title}")
    
    # Cerrar el navegador
    driver.quit()
```

#### **Conclusión**

Las Desired Capabilities en Selenium son una herramienta esencial para configurar entornos de prueba personalizados. Permiten definir aspectos del navegador y la plataforma, lo que es especialmente útil en entornos de pruebas distribuidas como Selenium Grid. Con este conocimiento, ahora puedes configurar Selenium WebDriver para ejecutar pruebas en una variedad de entornos y situaciones.

#### **Prácticas Adicionales**

1. Configura un entorno de prueba para un dispositivo móvil emulado utilizando las Desired Capabilities para Chrome.
2. Ejecuta pruebas distribuidas en Selenium Grid en diferentes sistemas operativos y versiones de navegador.
3. Intenta configurar las Desired Capabilities para aceptar ventanas emergentes o habilitar extensiones en el navegador.

¡Ahora estás listo para automatizar pruebas con Selenium WebDriver utilizando Desired Capabilities de manera efectiva!