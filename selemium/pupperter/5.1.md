En Puppeteer, la interceptación de solicitudes permite manipular las solicitudes HTTP antes de que se completen. Una vez habilitada, cada solicitud se detendrá hasta que se continúe, responda o aborte. Esto se usa comúnmente para bloquear ciertos tipos de solicitudes (como imágenes) o para modificar las solicitudes antes de enviarlas.

### Ejemplo básico de interceptación de solicitudes

Este ejemplo bloquea todas las solicitudes de imágenes (`.png` y `.jpg`):

```javascript
import puppeteer from 'puppeteer';

(async () => {
  const browser = await puppeteer.launch();
  const page = await browser.newPage();
  await page.setRequestInterception(true);

  page.on('request', interceptedRequest => {
    if (interceptedRequest.isInterceptResolutionHandled()) return;

    if (interceptedRequest.url().endsWith('.png') || interceptedRequest.url().endsWith('.jpg')) {
      interceptedRequest.abort();
    } else {
      interceptedRequest.continue();
    }
  });

  await page.goto('https://example.com');
  await browser.close();
})();
```

### Manejadores múltiples y resoluciones asincrónicas

Puppeteer lanza una excepción si se intenta resolver una solicitud (con `abort`, `continue` o `respond`) después de que ya haya sido resuelta. Para evitar esto, es importante verificar si la solicitud ya ha sido manejada con `request.isInterceptResolutionHandled()` antes de llamar a cualquiera de estas funciones.

Cuando se trabaja con resoluciones asincrónicas, es posible que otro manejador resuelva la solicitud mientras se espera una operación asincrónica. Por eso, la comprobación de `isInterceptResolutionHandled()` solo es segura dentro de un bloque de código síncrono.

### Modo de Interceptación Cooperativa

El Modo de Interceptación Cooperativa permite que múltiples manejadores trabajen juntos. Las resoluciones (`abort`, `continue`, `respond`) deben especificar una prioridad numérica. La resolución con mayor prioridad "gana". Si hay empate, el orden de precedencia es `abort > respond > continue`. Para activar este modo, todas las resoluciones deben usar prioridad; de lo contrario, se activa el Modo Heredado.

Ejemplo de uso del Modo Cooperativo:

```javascript
page.setRequestInterception(true);

page.on('request', request => {
  if (request.isInterceptResolutionHandled()) return;
  request.abort('failed', 10); // Prioridad 10 para abortar
});

page.on('request', request => {
  if (request.isInterceptResolutionHandled()) return;
  request.continue(request.continueRequestOverrides(), 15); // Prioridad 15 para continuar
});

page.on('request', request => {
  if (request.isInterceptResolutionHandled()) return;
  request.respond(request.responseForRequest(), 15); // Prioridad 15 para responder
});
```

En este ejemplo, la solicitud será respondida en lugar de continuar, ya que `respond` y `continue` tienen la misma prioridad, pero `respond` tiene prioridad sobre `continue`.